# 第7章 事务

[TOC]

# 术语

ACID：原子性（Atomicity）、一致性（Consistency）、隔离性（Isolation）和持久性（Durability）

BASE：基本可用性（Basically Available）、软状态（Soft state）和最终一致性（Evental consistency）

# 什么是事务

事务将应用程序的多个读、写操作捆绑在一起称为一个逻辑操作单元。即事务中的所有读写是一个执行的整体，整个事务要么成功（提交），要么失败（中止或回滚）。如果失败，应用程序可以安全地重试。这样，由于不需要担心部分失败的情况，**应用层的错误处理就变得简单很多。**

事务是被认为创造出来的，**目的是简化应用层的变成模型。**

# 事务所提供的安全保证ACID

**原子性**所定义的特征：在出错时中止事务，并将部分完成的写入全部丢弃。

**一致性**只要是指数据库处于应用程序所期待的“预期状态”。原子性、隔离性和持久性是数据库自身的属性，而ACID中的一致性更多是应用层的属性。**应用程序可能借助数据库提供的原子性和隔离性，以达到一致性，但一致性本身并不源于数据库**。因此，字母C其实并不应该属于ACID。

**隔离性**：并发执行的多个事务相互隔离，不能交叉。

**持久性**：保证一旦事务提交成功，即使存在硬件故障或数据库崩溃，事务所写入的数据也不会消失。

# 事务的发展历史

1975年IBM推出第一个SQL数据库System R。几十年过去了，目前几乎所有的关系数据库和一些非关系数据库等系统（如MySQL、PostgreSQL、Oracle、SQL Server等）实现的事务于当年System R非常相似。

21世纪末，NoSQL数据库开始兴起。它们的目标是通过提供新的数据模型，以及内置的复制和分区等手段来改进传统的关系模型。然后事务却成了受害者：很多新一代的数据库完全放弃了事务支持，或者将其重新定义，即替换为比以前弱的多的保证。